<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Cushny and Peebles (1905) studied the effects of hydrobromides
related to scopolamine and atropine
in producing sleep. The sleep of mental patients was
measured without hypnotic (Control) and after treatment 
with one of three drugs: L. hyoscyamine hydrobromide (L_hyoscyamine),
L. hyoscine hydrobromide (L_hyoscyine), and
a mixture (racemic) form, DL_hyoscine, called atropine.  
The L (levo) and D (detro)
form of a given molecule are optical isomers (mirror images).
The drugs were given on alternate evenings, and the hours
of sleep were compared with the intervening control night.
Each of the drugs was tested in this manner a varying number of times in each subject.
The average number of hours of sleep for each treatment is the response.
Student (1908) used these data to illustrate the paired-sample t-test
in small samples, testing the hypothesis that the mean difference between
a given drug and the control condition was zero.  
This data set became well known when used by Fisher (1925).  Both Student
and Fisher had problems labeling the drugs correctly (see Senn &amp;amp; Richardson (1994)),
and consequently came to wrong conclusions.
But as well, the sample sizes (number of nights) for each mean differed widely,
ranging from 3-9, and this was not taken into account in their analyses.
To allow weighted analyses, the number of observations for each mean
is contained in the data frame CushnyPeeblesN."><title>Cushny-Peebles Data: Soporific Effects of Scopolamine Derivatives — CushnyPeebles • HistData</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.5/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cushny-Peebles Data: Soporific Effects of Scopolamine Derivatives — CushnyPeebles"><meta property="og:description" content="Cushny and Peebles (1905) studied the effects of hydrobromides
related to scopolamine and atropine
in producing sleep. The sleep of mental patients was
measured without hypnotic (Control) and after treatment 
with one of three drugs: L. hyoscyamine hydrobromide (L_hyoscyamine),
L. hyoscine hydrobromide (L_hyoscyine), and
a mixture (racemic) form, DL_hyoscine, called atropine.  
The L (levo) and D (detro)
form of a given molecule are optical isomers (mirror images).
The drugs were given on alternate evenings, and the hours
of sleep were compared with the intervening control night.
Each of the drugs was tested in this manner a varying number of times in each subject.
The average number of hours of sleep for each treatment is the response.
Student (1908) used these data to illustrate the paired-sample t-test
in small samples, testing the hypothesis that the mean difference between
a given drug and the control condition was zero.  
This data set became well known when used by Fisher (1925).  Both Student
and Fisher had problems labeling the drugs correctly (see Senn &amp;amp; Richardson (1994)),
and consequently came to wrong conclusions.
But as well, the sample sizes (number of nights) for each mean differed widely,
ranging from 3-9, and this was not taken into account in their analyses.
To allow weighted analyses, the number of observations for each mean
is contained in the data frame CushnyPeeblesN."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HistData</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Snow_deaths-duplicates.html">Duplicate and Missing Cases in Snow.deaths</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/HistData/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cushny-Peebles Data: Soporific Effects of Scopolamine Derivatives</h1>
      
      <div class="d-none name"><code>CushnyPeebles.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cushny and Peebles (1905) studied the effects of hydrobromides
related to scopolamine and atropine
in producing sleep. The sleep of mental patients was
measured without hypnotic (<code>Control</code>) and after treatment 
with one of three drugs: L. hyoscyamine hydrobromide (<code>L_hyoscyamine</code>),
L. hyoscine hydrobromide (<code>L_hyoscyine</code>), and
a mixture (racemic) form, <code>DL_hyoscine</code>, called atropine.  
The L (levo) and D (detro)
form of a given molecule are optical isomers (mirror images).</p>
<p>The drugs were given on alternate evenings, and the hours
of sleep were compared with the intervening control night.
Each of the drugs was tested in this manner a varying number of times in each subject.
The average number of hours of sleep for each treatment is the response.</p>
<p>Student (1908) used these data to illustrate the paired-sample t-test
in small samples, testing the hypothesis that the mean difference between
a given drug and the control condition was zero.  
This data set became well known when used by Fisher (1925).  Both Student
and Fisher had problems labeling the drugs correctly (see Senn &amp; Richardson (1994)),
and consequently came to wrong conclusions.</p>
<p>But as well, the sample sizes (number of nights) for each mean differed widely,
ranging from 3-9, and this was not taken into account in their analyses.
To allow weighted analyses, the number of observations for each mean
is contained in the data frame <code>CushnyPeeblesN</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CushnyPeeblesN</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p><code>CushnyPeebles</code>: A data frame with 11 observations on the following 4 variables.</p><dl><dt><code>Control</code></dt>
<dd><p>a numeric vector: mean hours of sleep</p></dd>

    <dt><code>L_hyoscyamine</code></dt>
<dd><p>a numeric vector: mean hours of sleep</p></dd>

    <dt><code>L_hyoscine</code></dt>
<dd><p>a numeric vector: mean hours of sleep</p></dd>

    <dt><code>D_hyoscine</code></dt>
<dd><p>a numeric vector: mean hours of sleep</p></dd>

  
</dl><p><code>CushnyPeeblesN</code>:   A data frame with 11 observations on the following 4 variables.</p><dl><dt><code>Control</code></dt>
<dd><p>a numeric vector: number of observations</p></dd>

    <dt><code>L_hyoscyamine</code></dt>
<dd><p>a numeric vector: number of observations</p></dd>

    <dt><code>L_hyoscine</code></dt>
<dd><p>a numeric vector: number of observations</p></dd>

    <dt><code>DL_hyoscine</code></dt>
<dd><p>a numeric vector: number of observations</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The last patient (11) has no <code>Control</code> observations, and so is often excluded
in analyses or other versions of this data set.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Cushny, A. R., and Peebles, A. R. (1905), "The Action of Optical Isomers. II:
Hyoscines," <em>Journal of Physiology</em>, 32, 501-510.</p>
<p><!-- % Senn, Stephen, Data from Cushny and Peebles, \url{http://www.senns.demon.co.uk/Data/Cushny.xls} --></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Fisher, R. A. (1925), <em>Statistical Methods for Research Workers</em>, Edinburgh and London:
Oliver &amp; Boyd.</p>
<p>Student (1908), "The Probable Error of a Mean," <em>Biometrika</em>, 6, 1-25.</p>
<p>Senn, S.J. and Richardson, W. (1994), "The first t-test", <em>Statistics in Medicine</em>, 13, 785-803.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/datasets/sleep.html" class="external-link">sleep</a></code> for an alternative form of this data set.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># quick looks at the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CushnyPeebles-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">CushnyPeebles</span>, ylab<span class="op">=</span><span class="st">"Hours of Sleep"</span>, xlab<span class="op">=</span><span class="st">"Treatment"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CushnyPeebles-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##########################</span></span></span>
<span class="r-in"><span><span class="co"># Repeated measures MANOVA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CPmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Control</span>, <span class="va">L_hyoscyamine</span>, <span class="va">L_hyoscine</span>, <span class="va">DL_hyoscine</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">CushnyPeebles</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign within-S factor and contrasts</span></span></span>
<span class="r-in"><span><span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">Treatment</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>     <span class="fl">0</span>,<span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>     <span class="fl">0</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">Treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control.Drug"</span>, <span class="st">"L.DL"</span>, <span class="st">"L_hy.DL_hy"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Treats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">CPaov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">CPmod</span>, idata<span class="op">=</span><span class="va">Treats</span>, idesign<span class="op">=</span> <span class="op">~</span><span class="va">Treatment</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: model has only an intercept; equivalent type-III tests substituted.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type III Repeated Measures MANOVA Tests: Pillai test statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df test stat approx F num Df den Df    Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  1   0.90437   85.113      1      9 6.969e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment    1   0.70354    5.537      3      7   0.02896 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CPaov</span>, univariate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type III Repeated Measures MANOVA Tests:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Term: (Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Response transformation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Control                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L_hyoscyamine           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L_hyoscine              1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DL_hyoscine             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum of squares and products for the hypothesis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      3385.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate Tests: (Intercept)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Df test stat approx F num Df den Df     Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pillai            1  0.904370 85.11285      1      9 6.9692e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wilks             1  0.095630 85.11285      1      9 6.9692e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hotelling-Lawley  1  9.456983 85.11285      1      9 6.9692e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Roy               1  9.456983 85.11285      1      9 6.9692e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Term: Treatment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Response transformation matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               TreatmentControl.Drug TreatmentL.DL TreatmentL_hy.DL_hy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Control                          -3             0                   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L_hyoscyamine                     1            -2                   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L_hyoscine                        1             1                  -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DL_hyoscine                       1             1                   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum of squares and products for the hypothesis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       TreatmentControl.Drug TreatmentL.DL TreatmentL_hy.DL_hy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TreatmentControl.Drug                291.60       170.100              -0.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TreatmentL.DL                        170.10        99.225              -0.315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TreatmentL_hy.DL_hy                   -0.54        -0.315               0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate Tests: Treatment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Df test stat approx F num Df den Df   Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pillai            1 0.7035419  5.53737      3      7 0.028955 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wilks             1 0.2964581  5.53737      3      7 0.028955 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hotelling-Lawley  1 2.3731584  5.53737      3      7 0.028955 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Roy               1 2.3731584  5.53737      3      7 0.028955 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots/" class="external-link">heplots</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="http://friendly.github.io/heplots/reference/heplot.html" class="external-link">heplot</a></span><span class="op">(</span><span class="va">CPmod</span>, idata<span class="op">=</span><span class="va">Treats</span>, idesign<span class="op">=</span> <span class="op">~</span><span class="va">Treatment</span>, iterm<span class="op">=</span><span class="st">"Treatment"</span>, </span></span>
<span class="r-in"><span>  xlab<span class="op">=</span><span class="st">"Control vs Drugs"</span>, ylab<span class="op">=</span><span class="st">"L vs DL drug"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">CPmod</span>, idata<span class="op">=</span><span class="va">Treats</span>, idesign<span class="op">=</span> <span class="op">~</span><span class="va">Treatment</span>, iterm<span class="op">=</span><span class="st">"Treatment"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: heplots</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: broom</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: model has only an intercept; equivalent type-III tests substituted.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: model has only an intercept; equivalent type-III tests substituted.</span>
<span class="r-plt img"><img src="CushnyPeebles-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="CushnyPeebles-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">################################</span></span></span>
<span class="r-in"><span><span class="co"># reshape to long format, add Ns</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CPlong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">CushnyPeebles</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">CPlong</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"sleep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CPN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">CushnyPeeblesN</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CPlong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>patient<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span>,<span class="fl">4</span><span class="op">)</span>, <span class="va">CPlong</span>, n<span class="op">=</span><span class="va">CPN</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">CPlong</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	44 obs. of  4 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ patient  : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ treatment: Factor w/ 4 levels "Control","L_hyoscyamine",..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sleep    : num  0.6 3 4.7 5.5 6.2 3.2 2.5 2.8 1.1 2.9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ n        : int  9 9 8 9 9 8 8 7 8 9 ...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

