<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In the second issue of Biometrika, W. R. Macdonell (1902) published an extensive
paper, On Criminal Anthropometry and the Identification of Criminals
in which he included numerous tables of physical characteristics 3000 non-habitual 
male criminals serving their sentences in England and Wales.  His Table III (p. 216)
recorded a bivariate frequency distribution of height by finger length.
His main purpose was to show that Scotland Yard 
could have indexed their material more efficiently, and find a given profile more quickly.
W. S. Gosset (aka &quot;Student&quot;) used these data in two classic papers in 1908,
in which he derived various
characteristics of the sampling distributions of the mean, standard deviation and
Pearson's r. He said, &quot;Before I had succeeded in solving my problem analytically, I
had endeavoured to do so empirically.&quot;  Among his experiments, he randomly shuffled
the 3000 observations from Macdonell's table, and then grouped them into samples
of size 4, 8, ..., calculating the sample means, standard deviations and correlations
for each sample."><title>Macdonell's Data on Height and Finger Length of Criminals, used by Gosset (1908) — Macdonell • HistData</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.5/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Macdonell's Data on Height and Finger Length of Criminals, used by Gosset (1908) — Macdonell"><meta property="og:description" content="In the second issue of Biometrika, W. R. Macdonell (1902) published an extensive
paper, On Criminal Anthropometry and the Identification of Criminals
in which he included numerous tables of physical characteristics 3000 non-habitual 
male criminals serving their sentences in England and Wales.  His Table III (p. 216)
recorded a bivariate frequency distribution of height by finger length.
His main purpose was to show that Scotland Yard 
could have indexed their material more efficiently, and find a given profile more quickly.
W. S. Gosset (aka &quot;Student&quot;) used these data in two classic papers in 1908,
in which he derived various
characteristics of the sampling distributions of the mean, standard deviation and
Pearson's r. He said, &quot;Before I had succeeded in solving my problem analytically, I
had endeavoured to do so empirically.&quot;  Among his experiments, he randomly shuffled
the 3000 observations from Macdonell's table, and then grouped them into samples
of size 4, 8, ..., calculating the sample means, standard deviations and correlations
for each sample."><meta property="og:image" content="https://friendly.github.io/HistData/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HistData</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Snow_deaths-duplicates.html">Duplicate and Missing Cases in Snow.deaths</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/HistData/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Macdonell's Data on Height and Finger Length of Criminals, used by Gosset (1908)</h1>
      
      <div class="d-none name"><code>Macdonell.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In the second issue of <em>Biometrika</em>, W. R. Macdonell (1902) published an extensive
paper, <em>On Criminal Anthropometry and the Identification of Criminals</em>
in which he included numerous tables of physical characteristics 3000 non-habitual 
male criminals serving their sentences in England and Wales.  His Table III (p. 216)
recorded a bivariate frequency distribution of <code>height</code> by <code>finger</code> length.
His main purpose was to show that Scotland Yard 
could have indexed their material more efficiently, and find a given profile more quickly.</p>
<p>W. S. Gosset (aka "Student") used these data in two classic papers in 1908,
in which he derived various
characteristics of the sampling distributions of the mean, standard deviation and
Pearson's r. He said, "Before I had succeeded in solving my problem analytically, I
had endeavoured to do so empirically."  Among his experiments, he randomly shuffled
the 3000 observations from Macdonell's table, and then grouped them into samples
of size 4, 8, ..., calculating the sample means, standard deviations and correlations
for each sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Macdonell</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MacdonellDF</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p><code>Macdonell</code>: A frequency data frame with 924 observations on the following 3 variables giving
  the bivariate frequency distribution of <code>height</code> and <code>finger</code>.</p><dl><dt><code>height</code></dt>
<dd><p>lower class boundaries of height, in decimal ft.</p></dd>

    <dt><code>finger</code></dt>
<dd><p>length of the left middle finger, in mm.</p></dd>

    <dt><code>frequency</code></dt>
<dd><p>frequency of this combination of <code>height</code> and <code>finger</code></p></dd>

  
</dl><p><code>MacdonellDF</code>: A data frame with 3000 observations on the following 2 variables.</p><dl><dt><code>height</code></dt>
<dd><p>a numeric vector</p></dd>

    <dt><code>finger</code></dt>
<dd><p>a numeric vector</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Class intervals for <code>height</code> in Macdonell's table were given in 1 in.
ranges, from (4' 7" 9/16 - 4' 8" 9/16), to (6' 4" 9/16 - 6' 5" 9/16).
The values of <code>height</code> are taken as the lower class boundaries.</p>
<p>For convenience, the data frame <code>MacdonellDF</code> presents the same data, in expanded form, with
each combination of <code>height</code> and <code>finger</code> replicated <code>frequency</code> times.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Macdonell, W. R. (1902).
On Criminal Anthropometry and the Identification of Criminals.
<em>Biometrika</em>, 1(2), 177-227. 
doi: <a href="https://doi.org/10.1093/biomet/1.2.177" class="external-link">10.1093/biomet/1.2.177</a>

<!-- % \url{http://www.jstor.org/stable/2331487} --></p>
<p>The data used here were obtained from:</p>
<p>Hanley, J. (2008).
Macdonell data used by Student.
<a href="http://www.medicine.mcgill.ca/epidemiology/hanley/Student/" class="external-link">http://www.medicine.mcgill.ca/epidemiology/hanley/Student/</a></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hanley, J. and Julien, M. and Moodie, E. (2008).
Student's z, t, and s: What if Gosset had R?
<em>The American Statistician</em>, 62(1), 64-69.</p>
<p>Gosset, W. S. [Student] (1908).
Probable error of a mean.
<em>Biometrika</em>, 6(1), 1-25.
<a href="https://www.york.ac.uk/depts/maths/histstat/student.pdf" class="external-link">https://www.york.ac.uk/depts/maths/histstat/student.pdf</a></p>
<p>Gosset, W. S. [Student] (1908).
Probable error of a correlation coefficient.
<em>Biometrika</em>, 6, 302-310.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Macdonell</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># display the frequency table</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">frequency</span> <span class="op">~</span> <span class="va">finger</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">height</span>,<span class="fl">3</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Macdonell</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       round(height, 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> finger 4.63 4.714 4.797 4.88 4.964 5.047 5.13 5.214 5.297 5.38 5.464 5.547 5.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.4     0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.5     0     0     0    0     0     1    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.6     0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.7     0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.8     0     0     0    0     0     0    1     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.9     0     0     1    0     1     0    1     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10      1     0     0    1     2     0    2     0     0    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.1    0     0     0    1     3     1    0     1     1    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.2    0     0     2    2     2     1    0     2     0    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.3    0     1     1    3     2     2    3     5     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.4    0     0     1    1     2     3    3     4     3    3     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.5    0     0     0    1     3     7    6     4     3    1     3     1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.6    0     0     0    1     4     5    9    14     6    3     1     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.7    0     0     1    2     4     9   14    16    15    7     3     1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.8    0     0     0    2     5     6   14    27    10    7     1     2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.9    0     0     0    0     2     6   14    24    27   14    10     4    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11      0     0     0    2     6    12   15    31    37   27    17    10    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.1    0     0     0    3     3    12   22    26    24   26    24     7    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.2    0     0     0    3     2     7   21    30    38   29    27    20    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.3    0     0     0    1     0     5   10    24    26   39    26    24    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.4    0     0     0    0     3     4    9    29    56   58    26    22   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.5    0     0     0    0     0     5   11    17    33   57    38    34   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.6    0     0     0    0     2     1    4    13    37   39    48    38   27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.7    0     0     0    0     0     2    9    17    30   37    48    45   24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.8    0     0     0    0     1     0    2    11    15   35    41    34   29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.9    0     0     0    0     1     1    2    12    10   27    32    35   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12      0     0     0    0     0     0    1     4     8   19    42    39   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.1    0     0     0    0     0     0    0     2     4   13    22    28   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.2    0     0     0    0     0     0    1     2     5    6    23    17   16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.3    0     0     0    0     0     0    0     0     4    8    10    13   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.4    0     0     0    0     0     0    1     1     1    2     7    12    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.5    0     0     0    0     0     0    0     1     0    1     3    12   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.6    0     0     0    0     0     0    0     0     0    1     0     3    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.7    0     0     0    0     0     0    0     0     0    1     1     7    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.8    0     0     0    0     0     0    0     0     0    0     1     2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.9    0     0     0    0     0     0    0     0     0    0     0     1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13      0     0     0    0     0     0    0     0     0    0     3     0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.1    0     0     0    0     0     0    0     0     0    0     0     1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.2    0     0     0    0     0     0    0     0     0    0     1     1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.3    0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.4    0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.5    0     0     0    0     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       round(height, 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> finger 5.714 5.797 5.88 5.964 6.047 6.13 6.214 6.297 6.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.4      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.5      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.6      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.7      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.8      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.9      0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10       0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.1     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.2     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.3     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.4     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.5     1     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.6     1     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.7     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.8     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10.9     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11       0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.1     1     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.2     1     0    0     0     0    0     0     0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.3     2     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.4    11     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.5    11     2    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.6    12     2    2     0     1    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.7     9     9    2     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.8    10     5    1     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.9    10     9    3     1     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12      16     8    2     2     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.1    27    10    4     1     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.2    11     8    1     1     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.3    23     6    5     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.4     7     7    1     0     0    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.5     8     6    8     0     2    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.6     7     8    6     3     1    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.7     5     8    2     2     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.8     1     8    5     3     1    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12.9     2     0    1     1     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13       0     1    0     2     1    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.1     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.2     1     0    3     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.3     0     0    0     1     0    1     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.4     0     0    0     0     0    0     0     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   13.5     0     0    0     0     1    0     0     0    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Some examples by james.hanley@mcgill.ca    October 16, 2011</span></span></span>
<span class="r-in"><span><span class="co">## http://www.biostat.mcgill.ca/hanley/</span></span></span>
<span class="r-in"><span><span class="co">## See:  http://www.biostat.mcgill.ca/hanley/Student/</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################################</span></span></span>
<span class="r-in"><span><span class="co">##  naive contour plots of height and finger ##</span></span></span>
<span class="r-in"><span><span class="co">###############################################</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># make a 22 x 42 table</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">Macdonell</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">fi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">finger</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">frequency</span>, nrow<span class="op">=</span><span class="fl">42</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="va">Macdonell</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">10</span>, height<span class="op">=</span><span class="fl">5</span><span class="op">)</span>  <span class="co"># make plot double wide</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dx</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">/</span><span class="fl">12</span></span></span>
<span class="r-in"><span><span class="va">dy</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">/</span><span class="fl">12</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ht</span>,<span class="va">ht</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span><span class="op">-</span><span class="va">dx</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span><span class="op">+</span><span class="va">dx</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span><span class="op">-</span><span class="va">dy</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span><span class="op">+</span><span class="va">dy</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, type<span class="op">=</span><span class="st">"n"</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># unpack  3000 heights while looping though the frequencies </span></span></span>
<span class="r-in"><span><span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">42</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">f</span>  <span class="op">&lt;-</span>  <span class="va">fr</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span><span class="op">(</span><span class="va">f</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">heights</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ht</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">f</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span><span class="op">(</span><span class="va">f</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">ht</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">fi</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.4</span>, col<span class="op">=</span><span class="st">"grey40"</span> <span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">4.65</span>,<span class="fl">13.5</span>, <span class="st">"Finger length (cm)"</span>,adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> ;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">5.75</span>,<span class="fl">9.5</span>, <span class="st">"Height (feet)"</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> ;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">6.1</span>,<span class="fl">11</span>, <span class="st">"Observed bin\nfrequencies"</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey40"</span>,cex<span class="op">=</span><span class="fl">0.85</span><span class="op">)</span> ;</span></span>
<span class="r-in"><span><span class="co"># crude countour plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">ht</span>, <span class="va">fi</span>, <span class="va">fr</span>, add<span class="op">=</span><span class="cn">TRUE</span>, drawlabels<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># smoother contour plot (Galton smoothed 2-D frequencies this way)</span></span></span>
<span class="r-in"><span><span class="co"># [Galton had experience with plotting isobars for meteorological data]</span></span></span>
<span class="r-in"><span><span class="co"># it was the smoothed plot that made him remember his 'conic sections'</span></span></span>
<span class="r-in"><span><span class="co"># and ask a mathematician to work out for him the iso-density</span></span></span>
<span class="r-in"><span><span class="co"># contours of a bivariate Gaussian distribution... </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dx</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">/</span><span class="fl">12</span>; <span class="va">dy</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>  ; <span class="co"># shifts caused by averaging</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ht</span>,<span class="va">ht</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, type<span class="op">=</span><span class="st">"n"</span>  <span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="va">sm.fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">21</span><span class="op">*</span><span class="fl">41</span><span class="op">)</span>,<span class="va">nrow</span> <span class="op">&lt;-</span> <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">21</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">41</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">smooth.freq</span>  <span class="op">&lt;-</span>  <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">fr</span><span class="op">[</span><span class="va">i</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">)</span> </span></span>
<span class="r-in"><span>     <span class="va">sm.fr</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span>  <span class="op">&lt;-</span>  <span class="va">smooth.freq</span></span></span>
<span class="r-in"><span>     <span class="kw">if</span><span class="op">(</span><span class="va">smooth.freq</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">ht</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">dx</span>, <span class="va">fi</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">+</span><span class="va">dy</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^0."</span>, <span class="st">"."</span>,<span class="fu"><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString</a></span><span class="op">(</span><span class="va">smooth.freq</span><span class="op">)</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.4</span>, col<span class="op">=</span><span class="st">"grey40"</span> <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">ht</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">21</span><span class="op">]</span><span class="op">+</span><span class="va">dx</span>, <span class="va">fi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">41</span><span class="op">]</span><span class="op">+</span><span class="va">dy</span>, <span class="va">sm.fr</span>, add<span class="op">=</span><span class="cn">TRUE</span>, drawlabels<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">6.05</span>,<span class="fl">11</span>, <span class="st">"Smoothed bin\nfrequencies"</span>, adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey40"</span>, cex<span class="op">=</span><span class="fl">0.85</span><span class="op">)</span> ;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span>    <span class="co"># new default device</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#######################################</span></span></span>
<span class="r-in"><span><span class="co">## bivariate kernel density estimate</span></span></span>
<span class="r-in"><span><span class="co">#######################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">KernSmooth</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">MDest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">bkde2D</a></span><span class="op">(</span><span class="va">MacdonellDF</span>, bandwidth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">MDest</span><span class="op">$</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">MDest</span><span class="op">$</span><span class="va">x2</span>, z<span class="op">=</span><span class="va">MDest</span><span class="op">$</span><span class="va">fhat</span>,</span></span>
<span class="r-in"><span>  xlab<span class="op">=</span><span class="st">"Height (feet)"</span>, ylab<span class="op">=</span><span class="st">"Finger length (cm)"</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">MacdonellDF</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">finger</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: KernSmooth</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> KernSmooth 2.23 loaded</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Copyright M. P. Wand 1997-2009</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################################################</span></span></span>
<span class="r-in"><span><span class="co">## sunflower plot of height and finger with data ellipses  ##</span></span></span>
<span class="r-in"><span><span class="co">#############################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">MacdonellDF</span>, </span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/sunflowerplot.html" class="external-link">sunflowerplot</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">finger</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">12</span>, seg.col<span class="op">=</span><span class="st">"green3"</span>,</span></span>
<span class="r-in"><span>    xlab<span class="op">=</span><span class="st">"Height (feet)"</span>, ylab<span class="op">=</span><span class="st">"Finger length (cm)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">finger</span> <span class="op">~</span> <span class="va">height</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/Ellipses.html" class="external-link">dataEllipse</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">finger</span>, plot.points<span class="op">=</span><span class="cn">FALSE</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.40</span>, <span class="fl">.68</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############################################################</span></span></span>
<span class="r-in"><span><span class="co">## Sampling distributions of sample sd (s) and z=(ybar-mu)/s</span></span></span>
<span class="r-in"><span><span class="co">############################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that Gosset used a divisor of n (not n-1) to get the sd.</span></span></span>
<span class="r-in"><span><span class="co"># He also used Sheppard's correction for the 'binning' or grouping.</span></span></span>
<span class="r-in"><span><span class="co"># with concatenated height measurements...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">heights</span><span class="op">)</span> ; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="fl">3000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">heights</span><span class="op">)</span><span class="op">/</span><span class="fl">2999</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.4196250 0.2131819</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 750 samples of size n=4 (as Gosset did)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see Student's z, t, and s: What if Gosset had R? </span></span></span>
<span class="r-in"><span><span class="co"># [Hanley J, Julien M, and Moodie E. The American Statistician, February 2008] </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see also the photographs from Student's notebook ('Original small sample data and notes")</span></span></span>
<span class="r-in"><span><span class="co"># under the link "Gosset' 750 samples of size n=4" </span></span></span>
<span class="r-in"><span><span class="co"># on website http://www.biostat.mcgill.ca/hanley/Student/</span></span></span>
<span class="r-in"><span><span class="co"># and while there, look at the cover of the Notebook containing his yeast-cell counts</span></span></span>
<span class="r-in"><span><span class="co"># http://www.medicine.mcgill.ca/epidemiology/hanley/Student/750samplesOf4/Covers.JPG</span></span></span>
<span class="r-in"><span><span class="co"># (Biometrika 1907) and decide for yourself why Gosset, when forced to write under a </span></span></span>
<span class="r-in"><span><span class="co"># pen-name, might have taken the name he did!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PS: Can you figure out what the 750 pairs of numbers signify?</span></span></span>
<span class="r-in"><span><span class="co"># hint: look again at the numbers of rows and columns in Macdonell's (frequency) Table III.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">Nsamples</span> <span class="op">&lt;-</span> <span class="fl">750</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y.bar.values</span> <span class="op">&lt;-</span> <span class="va">s.over.sigma.values</span> <span class="op">&lt;-</span> <span class="va">z.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">samp</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Nsamples</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">heights</span>,<span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">s</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y.bar</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">/</span><span class="va">s</span></span></span>
<span class="r-in"><span>  <span class="va">y.bar.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y.bar.values</span>,<span class="va">y.bar</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">s.over.sigma.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s.over.sigma.values</span>,<span class="va">s</span><span class="op">/</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">z.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z.values</span>,<span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">2.5</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># sampling distributions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">heights</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">6.5</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Histogram of heights (N=3000)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">y.bar.values</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Histogram of y.bar (n="</span>,<span class="va">n</span>,<span class="st">")"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">s.over.sigma.values</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Histogram of s/sigma (n="</span>,<span class="va">n</span>,<span class="st">")"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>; </span></span>
<span class="r-in"><span><span class="va">z</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">0.25</span><span class="op">)</span><span class="op">+</span><span class="fl">0.125</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">z.values</span>,breaks<span class="op">=</span><span class="va">z</span><span class="op">-</span><span class="fl">0.125</span>, main<span class="op">=</span><span class="st">"Histogram of z=(ybar-mu)/s"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in hist.default(z.values, breaks = z - 0.125, main = "Histogram of z=(ybar-mu)/s"):</span> some 'x' not counted; maybe 'breaks' do not span range of 'x'</span>
<span class="r-in"><span><span class="co"># theoretical</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">z</span>, <span class="fl">750</span><span class="op">*</span><span class="fl">0.25</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">z</span>,<span class="fl">3</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####################################################</span></span></span>
<span class="r-in"><span><span class="co">## Chisquare probability plot for bivariate normality</span></span></span>
<span class="r-in"><span><span class="co">#####################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">MacdonellDF</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">MacdonellDF</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Dsq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/mahalanobis.html" class="external-link">mahalanobis</a></span><span class="op">(</span><span class="va">MacdonellDF</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3000</span><span class="op">/</span><span class="fl">3000</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">Dsq</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Chisquare (2) quantile"</span>, ylab<span class="op">=</span><span class="st">"Squared distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>, b<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

